import{r as N,k as e,L as qe}from"./react-vendor-BZalFSLS.js";import{e_ as H,e$ as V,f0 as le,f1 as ce,eV as me,eT as Ve,f2 as $e,f3 as ze,f4 as Be,eN as k,f5 as oe,f6 as We,f7 as ie,f8 as X,f9 as Ce,fa as Ye,fb as He,fc as we,fd as Ue,fe as ee,ff as Ke,eO as Je,fg as xe,fh as Ge,fi as Qe,fj as Xe}from"./other-vendor-BouohHGO.js";import{F as ae,T as z,c as B,S as Ze,d as O,D as Fe,I as je,e as be,f as K,b as et,a as te,P as tt}from"./index-BP21z_dk.js";import{M as E}from"./lodash-vendor-CN3hPSWb.js";import{u as Ne,a as st}from"./index-DySw3dyO.js";import{h as G,R as L,f as U,C as M,T as J,B as P,a as re,s as A,S as W,p as Ie,e as Z,c as de,U as nt,F as D,q as Ee,I as Oe,r as ot,u as se,n as it,E as Ae,o as at,G as rt,v as lt}from"./antd-vendor-ZYx89x1p.js";import{d as v}from"./decimal-vendor-W8_pUBKB.js";import{L as ct,S as dt}from"./antv-vendor-CgHx07mi.js";import"./__commonjsHelpers__-Cpj98o6Y.js";const ue=H({key:"projectDataState",default:[]}),ve=H({key:"taskDataLoading",default:!1}),fe=H({key:"triggerGetDataState",default:null}),pe=H({key:"deleteDataState",default:null}),_e=H({key:"createOrModifiedDataState",default:null}),ut=H({key:"getDatatState",default:null}),Re=H({key:"projectDetailState",default:null}),ft=Object.freeze({light:"轻同位素",heavy:"重同位素",cell:"晶胞参数"});function pt(n){const{status:a}=n;switch(a){case z.WAITING:return e.jsx(Z,{icon:e.jsx($e,{}),color:"default",style:{fontWeight:800},children:"待计算"});case z.RUNNING:return e.jsx(Z,{icon:e.jsx(Ve,{spin:!0}),color:"processing",style:{fontWeight:800},children:"计算中"});case z.SUCCESS:return e.jsx(Z,{icon:e.jsx(le,{}),color:"success",style:{fontWeight:800},children:"已完成"});case z.FAILED:return e.jsx(U,{title:"请点击编辑重新上传计算文件后发起计算，或者删除重建计算任务",children:e.jsx(Z,{icon:e.jsx(ce,{}),color:"error",children:"计算失败"})});default:return e.jsx(e.Fragment,{})}}function ht(n){const{onEdit:a,isAction:o,onSelect:p,actionSelectList:s,fileInfoList:r,taskId:l,taskName:T,createTime:m,updateTime:h,calculationStatus:c}=n,S=V(pe),y=V(fe),F=Ne(),w=d=>{d.target.checked||!1?p==null||p(i=>[...i??[],l]):p==null||p(i=>i?i.filter(g=>g!==l):[])},f=N.useMemo(()=>(s==null?void 0:s.includes(l))||!1,[s,l]),u=N.useMemo(()=>{var I,R,j,x,_,b;const{light:d,heavy:t,cell:i}=r||{},g=[];return E.isEmpty(d)||g.push({name:(I=d==null?void 0:d[0])==null?void 0:I.name,status:(R=d==null?void 0:d[0])==null?void 0:R.status,type:"light"}),E.isEmpty(t)||g.push({name:(j=t==null?void 0:t[0])==null?void 0:j.name,status:(x=t==null?void 0:t[0])==null?void 0:x.status,type:"heavy"}),E.isEmpty(i)||g.push({name:(_=i==null?void 0:i[0])==null?void 0:_.name,status:(b=i==null?void 0:i[0])==null?void 0:b.status,type:"cell"}),g},[r]);return e.jsxs(G,{title:e.jsxs(e.Fragment,{children:[e.jsx(L,{children:e.jsx(U,{title:T,placement:"top",children:e.jsx(M,{style:{textOverflow:"ellipsis",overflow:"hidden",maxWidth:180},children:T||"-"})})}),e.jsx(L,{children:e.jsx(M,{style:{textOverflow:"ellipsis",overflow:"hidden",maxWidth:180},children:e.jsx(U,{title:l,placement:"bottom",children:e.jsxs(J.Text,{type:"secondary",style:{fontWeight:400,fontSize:12},children:["ID: ",l]})})})})]}),extra:e.jsxs(L,{wrap:!1,align:"middle",children:[e.jsx(M,{children:e.jsx(P,{type:"link",onClick:a,children:"编辑"})}),e.jsx(M,{children:e.jsx(P,{type:"link",danger:!0,style:{paddingRight:0},onClick:()=>{re.confirm({title:"确认",content:`确认删除 ${T||""} 计算任务？`,onOk:()=>{(S==null?void 0:S(l))?A.success("删除任务成功！"):A.error("删除任务失败！"),y==null||y()},centered:!0})},children:"删除"})})]}),styles:{body:{position:"relative",overflow:"hidden"}},children:[e.jsxs(L,{wrap:!1,style:{marginBottom:3},children:[e.jsx(M,{style:{minWidth:"100px"},children:"计算任务状态："}),e.jsx(M,{children:e.jsx(pt,{status:c})})]}),e.jsxs(L,{wrap:!1,style:{marginBottom:3},children:[e.jsx(M,{style:{minWidth:"100px"},children:"上传文件信息："}),e.jsx(M,{style:{maxWidth:"100%",overflow:"auto",whiteSpace:"nowrap"},children:e.jsx(W,{children:u.map(d=>e.jsx(W,{align:"center",children:e.jsxs(U,{title:d.name,children:[ft[d.type],d.status===ae.DONE?e.jsx(le,{style:{color:"#52c41a",fontSize:12,marginLeft:1}}):e.jsx(ce,{style:{color:"red",fontSize:12,marginLeft:1}})]})}))})})]}),e.jsxs(L,{wrap:!1,style:{marginBottom:3},children:[e.jsx(M,{style:{minWidth:"100px"},children:"任务创建时间："}),e.jsx(M,{children:me(m).format("YYYY-MM-DD HH:mm:ss")})]}),e.jsxs(L,{wrap:!1,style:{marginBottom:3},children:[e.jsx(M,{style:{minWidth:"100px"},children:"任务修改时间："}),e.jsx(M,{children:me(h).format("YYYY-MM-DD HH:mm:ss")})]}),o?e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{width:130,height:160,backgroundColor:F==="dark"?"#000":"#f0f0f0",position:"absolute",bottom:-100,right:-40,transform:"rotate(60deg)",transition:"all .5s ease"}}),e.jsx(Ie,{style:{position:"absolute",bottom:10,right:5},checked:f,onChange:w,children:e.jsx(J.Text,{type:f?void 0:"secondary",children:"选择"})})]}):null]})}const mt=/\+\s+\d+\s+-?\d+\.?\d+\s+[a-z]\s+\d+\.?\d+\s+(?:N|Y)\s+(?:\d+\.?\d+)?\s+(?:N|Y)(?=\s+\+)/g,xt=/\+\s+\d+\s+-?\d+\.?\d+\s+[a-z](?:\s+\d+\.?\d+\s+(?:N|Y)\s+(?:\d+\.?\d+)?\s+(?:N|Y))?(?=\s+\+)/g,gt=/(?:\+\s+q-pt=\s+\d+\s+\(\s+-?\d+\.?\d+\s+-?\d+\.?\d+\s+-?\d+\.?\d+\)\s+)(\d+\.?\d+)(?=\s+\+)/g,yt=/Materials Studio CASTEP version (\d+)/,Pe=/type of calculation\s+:\s+(\w(?:\w|\s|-)*)(?=\r?\n)/,Tt=/Total number of ions in cell\s+=\s+(\d+)/,St=/Total number of species in cell\s+=\s+(\d+)/,Ct=/x\s+\w+\s+\d+\s+(?:-?\d+\.?\d+\s+)+(?:-?\d+\.?\d+)(?=\s+x)/g,wt=/Raman intensities\s+:\s+((?:\w)+\s?(?:\w)*)/,Ft=/\d+\s+\w+\s+\d+(?:\s+\d\.?\d+)+(?=\r?\n)/g,ge=/Mass of species in AMU\s+((?:\w+\s+\d+\.?\d+\s+)+)(?=Electric Quadrupole Moment)/,jt="2017";var ke=(n=>(n.E_FIELD="Phonon followed by E-field",n.PHONON="phonon calculation",n))(ke||{});const bt=["Phonon followed by E-field","phonon calculation"];var $=(n=>(n.INDEX="N",n.FREQUENCY="Frequency",n.IRREP="irrep",n.IR="ir intensity",n.IR_ACTIVE="ir active",n.RAMAN="raman activity",n.RAMAN_ACTIVE="raman active",n))($||{});const ye=["N","Frequency","irrep","ir intensity","ir active","raman activity","raman active"],Nt=Object.freeze({calculated:!0,"not calculated":!1}),Te=Object.freeze({Y:!0,N:!1});function Me(n){var p,s;const a=(p=n.match(yt))==null?void 0:p[1],o=((s=n.match(Pe))==null?void 0:s[1])||"";return a!==jt?{message:"CASTEP版本不支持！",isSupport:!1}:bt.includes(o)?{message:"",isSupport:!0}:{message:"计算类型设置不支持！",isSupport:!1}}function It(n){var o;const a=(o=n.match(wt))==null?void 0:o[1];return Nt[a]||!1}function Y(n){var o;return(((o=n.match(Pe))==null?void 0:o[1])||"")===ke.PHONON}function Et(n,a){const o=n.match(gt)||[];let p="0";const s=o.map(d=>{var g;const t=(g=d.split(/\s+/))==null?void 0:g[2];if(t&&t!==p){const I=E.last(d.split(/\s+/));return p=t,I}return"0"}),r=n.match(a?xt:mt)||[];if(r.length%s.length!==0)throw new Error("频率比例信息正则匹配出错，轻检查文件或者联系管理员～");const l=r.length/s.length,m=It(n)?ye:ye.filter(d=>d!==$.RAMAN),h=new Map(m.map(d=>[d,[]]));r.forEach(d=>{const t=d.split(/\s+/).filter(i=>i!=="+");m.forEach((i,g)=>{if(E.isNil(t[g]))return;const I=h.get(i)||[];h.set(i,[...I,t[g]])})});const c=[],S=h.get($.FREQUENCY)||[];s.forEach((d,t)=>{const i=t*l,g=(t+1)*l;c.push(S.slice(i,g))});const y=c,F=h.get($.IR)||[],w=h.get($.IR_ACTIVE)||[],f=h.get($.RAMAN)||[],u=h.get($.RAMAN_ACTIVE)||[];return{frequency:y,ir:F,irActve:w,raman:f,ramanActive:u,proportions:s}}function De(n){return Array.isArray(n)?Promise.all(n.map(a=>De(a))):new Promise((a,o)=>{const{isSupport:p,message:s}=Me(n);p||o(new Error(s));const r=Y(n),l=Et(n,r);a({...l,irActive:l.irActve.map(T=>Te[T]),ramanActive:l.ramanActive.map(T=>Te[T])})})}const{Dragger:Ot}=nt,Se={frequency:[],ir:[],irActive:[],raman:[],ramanActive:[],proportions:[]};function ne(n){var h,c;const{fileType:a,onChange:o,value:p,disabled:s}=n||{},[r,l]=N.useState(!1),T=S=>{l(!0);const{file:y,onSuccess:F,onError:w}=S||{},{name:f,uid:u}=y||{},d=new FileReader;d.readAsText(y),d.onload=async()=>{const t=d.result;try{let i;a===B.CASTEP&&(i=await De(t)),o==null||o({fileList:[{name:f,uid:u,status:ae.DONE}],text:t,info:a===B.CASTEP?i:void 0}),F==null||F({name:f,uid:u})}catch(i){const g=i!=null&&i.message?`上传文件失败：${i==null?void 0:i.message}`:"文件解析失败";o==null||o({fileList:[{name:f,uid:u,status:ae.ERROR,response:g}],text:"",info:a===B.CASTEP?Se:void 0}),A.error(g),w==null||w({name:f,message:g})}finally{l(!1)}}},m=()=>{o==null||o({fileList:[],text:"",info:a===B.CASTEP?Se:void 0})};return e.jsx(de,{spinning:r,children:e.jsxs(L,{style:{margin:0},align:"middle",wrap:!1,children:[e.jsx(M,{flex:1,children:e.jsx(Ot,{height:90,style:{display:E.isEmpty(p==null?void 0:p.fileList)?"block":"none"},iconRender:()=>e.jsx(ze,{}),fileList:(p==null?void 0:p.fileList)||[],listType:"picture",accept:a||"*",customRequest:T,maxCount:1,onRemove:m,disabled:s,children:E.isEmpty(p==null?void 0:p.fileList)?e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{height:"30px",fontSize:25,marginBottom:12},children:e.jsx(Be,{})}),e.jsx(J.Text,{type:"secondary",children:"请拖拽或者点击上传文件"})]}):null})}),((h=E.head(p==null?void 0:p.fileList))==null?void 0:h.status)==="done"?e.jsx(le,{style:{marginLeft:10,color:"#52c41a",transition:"all .5s linear"}}):null,((c=E.head(p==null?void 0:p.fileList))==null?void 0:c.status)==="error"?e.jsx(ce,{style:{marginLeft:10,color:"red",transition:"all .5s linear"}}):null]})})}function At(n){const a=n.match(Ft);return(a==null?void 0:a.map(p=>{const s=p.split(/\s+/),r=s==null?void 0:s[1],l=s==null?void 0:s[2],T=[s==null?void 0:s[3],s==null?void 0:s[4],s==null?void 0:s[5]];return{atom:r,index:Number(l),fixedSetting:T}}))||[]}function vt(n){var l,T,m,h;const{castepText_Heavy:a,castepText_Light:o}=n,p=((T=(l=a.match(ge))==null?void 0:l[1])==null?void 0:T.split(/\r?\n/).map(c=>c.trim()).filter(Boolean).map(c=>{const[S,y]=c.split(/\s+/);return{name:S,mass:y}}))||[],s=((h=(m=o.match(ge))==null?void 0:m[1])==null?void 0:h.split(/\r?\n/).map(c=>c.trim()).filter(Boolean).map(c=>{const[S,y]=c.split(/\s+/);return{name:S,mass:y}}))||[],r=[];for(let c=0;c<p.length;c++){const{name:S,mass:y}=p[c],{name:F,mass:w}=s[c];if(F===S&&y!==w){if(new v(w).greaterThanOrEqualTo(y))throw new Error("轻、重同位素质量设置相反，检查上传文件是否对应！");r.push({isotope:S,massSetting:{heavy:y,light:w}})}}if(r.length!==1)throw new Error("同位素质量设置错误！");return r[0]}function Le(n){return Array.isArray(n)?Promise.all(n.map(a=>Le(a))):new Promise((a,o)=>{var I,R;const p=n.cell||"",{heavy:s,light:r}=n.castep,l=n.isFixed,{isSupport:T,message:m}=Me(s);if(!T)return o(new Error(m));if(l&&!p)return o(new Error("未上传 .cell 文件！"));if(p&&!l)return o(new Error(".cell 文件解析显示计算同位素原子有被固定，请检查选择固定原子选项是否勾选正确！"));const h=Y(s),c=Y(r);if(h!==c)return o(new Error("轻、重同位素计算文件设置的计算类型不一致，请检查后重新计算！"));let S=[];l&&(S=At(p));const y=(I=s.match(Tt))==null?void 0:I[1],F=(R=s.match(St))==null?void 0:R[1],w=S.length/3,f=s.match(Ct),u=(f==null?void 0:f.map(j=>{const x=j==null?void 0:j.split(/\s+/),_=x==null?void 0:x[1],b=x==null?void 0:x[2],C=[x==null?void 0:x[3],x==null?void 0:x[4],x==null?void 0:x[5]];let q=!1;return l&&S.length&&(q=!!S.some(he=>he.atom===_&&he.index===Number(b))),{atom:_,index:Number(b),position:C,fixed:q}}))||[],d=vt({castepText_Heavy:s,castepText_Light:r}),t=S.some(j=>j.atom===d.isotope)?S.filter(j=>j.atom===d.isotope).length/3:0,i=u.filter(j=>j.atom===d.isotope).length-t,g={isotope:d.isotope,massSetting:d.massSetting,fixedIsotopeNumber:t,isotopeNumber:i};return a({atomNumbers:Number(y),atomTypeNumbers:Number(F),fixedAtomNumbers:w,atomPositionMatrix:u,isotopeSetting:g})})}const _t={isFixed:!1};function Rt(n){var w,f,u;const{projectDetail:a,cellInfo:o,heavyFile:p,lightFile:s}=n,r=a==null?void 0:a.calculationElement,l=a==null?void 0:a.isotopeMass,T=o.isotopeSetting.isotope,m=o.isotopeSetting.massSetting;if(r!==T)return{isFit:!1,reason:"解析文件的同位素与工程选择的同位素不一致，请检查后重新上传～"};const h=((w=l==null?void 0:l.heavy)==null?void 0:w.round)===v.round(m==null?void 0:m.heavy).toNumber(),c=((f=l==null?void 0:l.light)==null?void 0:f.round)===v.round(m==null?void 0:m.light).toNumber();if(!h||!c)return{isFit:!1,reason:"解析文件的同位素质量数与工程选择不一致，请检查后重新上传～"};const S=Y((p==null?void 0:p.text)||""),y=Y((s==null?void 0:s.text)||"");if(S!==y)return{isFit:!1,reason:"轻、重同位素 .castep 文件计算设置不一致，请检查后重新上传～"};const F=(u=a==null?void 0:a.calculationService)==null?void 0:u.includes(O.PHONON);return y&&!F?{isFit:!1,reason:"工程计算服务未勾选声子频率，请修改工程设置或者重新上传～"}:{isFit:!0,reason:""}}function Pt(n){const{isEdit:a,close:o,taskId:p}=n,[s]=D.useForm(),r=V(ue),l=V(_e),T=V(Re),[m,h]=N.useState(!1),[c,S]=N.useState();N.useEffect(()=>{const f=r==null?void 0:r.find(u=>(u==null?void 0:u.id)===p);S(f)},[r,p]),N.useEffect(()=>{h(!!a)},[a]),N.useEffect(()=>{console.log({taskItem:c})},[c]);const y=k(()=>{const f={taskName:c==null?void 0:c.name,isFixed:c==null?void 0:c.isFixed,lightFile:void 0,heavyFile:void 0,cellFile:void 0};s.setFieldsValue(f),h(!1)}),F=D.useWatch("isFixed",s);N.useEffect(()=>{var f,u,d;if(!a)s.setFieldsValue(_t);else{const t={taskName:c==null?void 0:c.name,isFixed:c==null?void 0:c.isFixed,lightFile:{fileList:(f=c==null?void 0:c.fileInfoList)==null?void 0:f.light},heavyFile:{fileList:(u=c==null?void 0:c.fileInfoList)==null?void 0:u.heavy},cellFile:{fileList:(d=c==null?void 0:c.fileInfoList)==null?void 0:d.cell}};s.setFieldsValue(t)}},[s,a,c]);const w=k(async()=>{if(await s.validateFields(),a&&m){try{if(!await(l==null?void 0:l({...c,name:s.getFieldValue("taskName")||"",updateTime:Date.now()},p)))throw new Error("创建计算任务失败！");A.success(`${a?"编辑":"创建"}计算任务成功！`),o==null||o()}catch(t){A.error(t.message||"创建计算任务失败！")}return}const f=s.getFieldValue("heavyFile"),u=s.getFieldValue("lightFile"),d=s.getFieldValue("cellFile");try{const t=await Le({castep:{heavy:(f==null?void 0:f.text)||"",light:(u==null?void 0:u.text)||""},cell:(d==null?void 0:d.text)||"",isFixed:F}),{isFit:i,reason:g}=Rt({projectDetail:T,cellInfo:t,heavyFile:f,lightFile:u});if(!i)throw new Error(g);const I=Y((f==null?void 0:f.text)||""),R=Y((u==null?void 0:u.text)||"");if(I!==R)throw new Error("轻、重同位素 .castep 文件计算设置不一致，请仔细检查文件");const j=s.getFieldValue("taskName")||"",x=a?p:oe();if(!x)throw new Error("未设置计算任务id，请联系管理员！");if(!await(l==null?void 0:l({name:j,id:x,calculationStatus:z.WAITING,createTime:a?(c==null?void 0:c.createTime)??Date.now():Date.now(),updateTime:Date.now(),isFixed:F,softWare:Ze.CASTEP,isPhonon:I,isotopeSetting:(t==null?void 0:t.isotopeSetting)||{},cellInfo:{atomNumbers:t==null?void 0:t.atomNumbers,atomPositionMatrix:t==null?void 0:t.atomPositionMatrix,atomTypeNumbers:t==null?void 0:t.atomTypeNumbers},heavyFreqInfo:(f==null?void 0:f.info)||[],lightFreqInfo:(u==null?void 0:u.info)||[],fileInfoList:{heavy:(f==null?void 0:f.fileList)||[],light:(u==null?void 0:u.fileList)||[],cell:(d==null?void 0:d.fileList)||[]}},x)))throw new Error("创建计算任务失败！");A.success("创建计算任务成功！"),o==null||o()}catch(t){A.error(t.message||"创建计算任务失败！")}});return e.jsx(e.Fragment,{children:e.jsx(G,{title:`${a?"编辑":"新建"}计算任务`,extra:e.jsx(W,{children:e.jsx(Ee,{options:[{label:"CASTEP",value:"CASTEP",disabled:!1},{label:"GAUSSIAN",value:"GAUSSIAN",disabled:!0}],defaultValue:"CASTEP"})}),actions:[e.jsx(P,{block:!0,size:"large",style:{width:"80%"},onClick:o,children:"取消"}),e.jsx(P,{type:"primary",block:!0,size:"large",style:{width:"80%"},onClick:()=>s==null?void 0:s.submit(),children:"确认"})],styles:{body:{maxHeight:"60vh",overflow:"scroll"}},children:e.jsxs(D,{form:s,labelCol:{span:6},onFinish:w,preserve:!1,onFinishFailed:()=>A.error("请完整填写任务选项！"),children:[e.jsx(D.Item,{label:"计算任务名",name:"taskName",rules:[{required:!0,message:"必须设置任务名"}],children:e.jsx(Oe,{placeholder:"请输入任务名字"})}),a?e.jsx(ot,{dashed:!0,plain:!0,children:e.jsxs(J.Text,{type:"secondary",style:{fontSize:12,fontWeight:400},children:["编辑态不允许直接修改计算文件，如需修改请",e.jsx(P,{type:"link",style:{fontSize:12,fontWeight:400,padding:2},onClick:y,children:"清空"}),"后重新上传"]})}):null,e.jsx(D.Item,{label:"是否固定原子",name:"isFixed",extra:"如果有固定需要计算同位素的原子，请选择「是」，其他情况请选择「否」",rules:[{required:!0,message:"请选择"}],children:e.jsxs(se.Group,{optionType:"button",buttonStyle:"solid",style:{marginBottom:5},disabled:m,children:[e.jsx(se,{value:!0,children:"是"}),e.jsx(se,{value:!1,children:"否"})]})}),e.jsx(D.Item,{label:"轻同位素",name:"lightFile",extra:"请上传文件格式为 .castep 的文件",rules:[{required:!0,message:"请上传轻同位素文件"}],children:e.jsx(ne,{fileType:B.CASTEP,disabled:m})}),e.jsx(D.Item,{label:"重同位素",name:"heavyFile",extra:"请上传文件格式为 .castep 的文件",rules:[{required:!0,message:"请上传重同位素文件"}],children:e.jsx(ne,{fileType:B.CASTEP,disabled:m})}),F?e.jsx(D.Item,{label:"晶胞文件",name:"cellFile",extra:"请上传文件格式为 .cell 的文件",rules:[{required:!0,message:"请上传晶胞文件"}],children:e.jsx(ne,{fileType:B.CELL,disabled:m})}):null]})})})}const kt=`
1. 请准备一个干净的文件夹，按照计算矿物分别创建子文件夹，子文件夹名会被当作为计算任务名。
2. 每个子文件夹的文件包含 重同位素频率文件（请更改命名为 heavy.castep ）、轻同位素频率文件（请更改命名为 light.castep ）、如果固定有计算同位素的原子还需要晶胞参数 .cell 文件。
3. 如果文件夹或者文件准备有问题，会导致批量上传失败，请注意检查！
`,{useBreakpoint:Mt}=rt;function Dt(n){const{visible:a,onClose:o}=n,{md:p}=Mt(),s=V(ue),r=V(fe),l=V(pe),T=V(ve),[m,h]=N.useState(!1),[c,S]=N.useState(!1),[y,F]=N.useState(""),[w,f]=N.useState(!1),[u,d]=N.useState(!1),[t,i]=N.useState([]),[g,I]=N.useState(!1),R=C=>{const q=C.target.checked||!1;I(q),i(q?(s==null?void 0:s.map(Q=>Q==null?void 0:Q.id))||[]:[])},j=k(()=>{h(!1)}),x=k(C=>{r==null||r(C)}),_=k(()=>{E.isEmpty(t)||!t||re.confirm({title:"确认",content:"确认删除选择的计算任务？",onOk:()=>{(l==null?void 0:l(t))?A.success("删除任务成功！"):A.error("删除任务失败！"),r==null||r()},centered:!0})}),b=k(()=>{o(),h(!1),f(!1),d(!1),i([]),I(!1)});return N.useEffect(()=>{(a||a&&!m)&&(r==null||r())},[m,r,a]),N.useEffect(()=>{if(E.isEmpty(s))d(!1);else{const C=E.isEqual(E.orderBy(t),E.orderBy((s==null?void 0:s.map(q=>q==null?void 0:q.id))||[]));I(C),!E.isEmpty(t)&&!C?d(!0):d(!1)}},[t,s]),N.useEffect(()=>(a?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[a]),e.jsxs(e.Fragment,{children:[e.jsxs(it,{title:"任务列表",id:"drawer",width:460,open:a,onClose:b,placement:p?"right":"bottom",height:"70vh",maskClosable:!1,extra:e.jsxs(e.Fragment,{children:[e.jsx(U,{title:()=>kt.split(`
`).map(C=>e.jsx("p",{style:{textAlign:"justify"},children:C})),children:e.jsxs(P,{type:"link",onClick:()=>A.warning("功能正在开发中，敬请期待～"),children:["批量上传",e.jsx(We,{})]})}),e.jsx(P,{type:"link",onClick:()=>{h(!0),S(!1),F("")},children:"新建任务"})]}),footer:e.jsxs(L,{justify:"space-between",align:"middle",children:[w?e.jsxs(W,{align:"center",children:[e.jsx(Ie,{checked:g,onChange:R,indeterminate:u,children:"全选"}),e.jsx(P,{type:"link",style:{padding:0},onClick:_,disabled:E.isEmpty(t)||!t,children:"删除"}),e.jsx(P,{type:"link",onClick:()=>{f(!1),i([]),I(!1)},style:{padding:0},children:"取消"})]}):e.jsx(P,{type:"link",onClick:()=>f(!0),children:"批量删除"}),e.jsx(J.Text,{type:"secondary",children:`${w?`已选 ${(t==null?void 0:t.length)||0} 个 /`:""} 共计 ${(s==null?void 0:s.length)||0} 个`}),e.jsx(P,{type:"primary",onClick:b,children:"关闭"})]}),children:[e.jsx(Oe.Search,{placeholder:"请输入计算任务名进行搜索",allowClear:!0,onSearch:x,style:{marginTop:-12}}),e.jsxs(de,{spinning:T,style:{marginTop:60},children:[s&&(s!=null&&s.length)?e.jsx(W,{direction:"vertical",style:{width:"100%"},children:s.map(C=>e.jsx(ht,{taskId:C==null?void 0:C.id,taskName:C==null?void 0:C.name,calculationStatus:C==null?void 0:C.calculationStatus,createTime:C==null?void 0:C.createTime,updateTime:C==null?void 0:C.updateTime,isAction:w,fileInfoList:C==null?void 0:C.fileInfoList,onSelect:i,actionSelectList:t,onEdit:()=>{h(!0),S(!0),F(C==null?void 0:C.id)}},C==null?void 0:C.id))}):e.jsx(Ae,{style:{marginTop:100}}),e.jsx(U,{title:"回到顶部",children:e.jsx(at.BackTop,{target:()=>{var C;return(C=document.getElementsByClassName("ant-drawer-body"))==null?void 0:C[0]},visibilityHeight:180,style:{marginBottom:20}})})]})]}),e.jsx(re,{open:m,footer:null,getContainer:()=>{var C;return(C=document.getElementsByClassName("ant-drawer-body"))==null?void 0:C[0]},closeIcon:null,destroyOnClose:!0,centered:!0,children:e.jsx(Pt,{taskId:y,close:j,isEdit:c})})]})}function Lt(n){const[a,o]=ie(ve),[p,s]=ie(ue),r=X(fe),l=X(pe),T=X(_e),m=X(ut),h=new Ce(Fe),c=h.verno;n?h.version(c||je).stores({[n]:be}):A.error("系统错误，未设置工程id，请联系管理员！");const S=k(f=>new Promise((u,d)=>{var t,i;if(!n)return d(new Error("系统错误，未设置工程id，请联系管理员！"));o(!0),(i=(t=h.table(n))==null?void 0:t.filter(g=>{var I;return f?(I=g==null?void 0:g.taskDetail)==null?void 0:I.name.includes(f):!0}))==null||i.toArray().then(g=>{setTimeout(()=>{o(!1),u(g)},Math.random()*1e3)}).catch(g=>{o(!1),d(g||new Error("查询计算任务失败！"))})})),y=k(async f=>{if(!n){A.error("系统错误，未设置工程id，请联系管理员！");return}try{const u=await S(f);s(u)}catch(u){A.error((u==null?void 0:u.message)||"获取任务失败！"),s([])}}),F=k(async f=>{var u;if(!n)return A.error("系统错误，未设置工程id，请联系管理员！"),!1;if(!f)return A.error("系统错误，未设置id，请联系管理员！"),!1;try{return await((u=h.table(n))==null?void 0:u.bulkDelete([...f])),!0}catch{return!1}}),w=k((f,u)=>new Promise((d,t)=>{if(!n)return t(new Error("系统错误，未设置工程id，请联系管理员！"));if(!u)return t(new Error("系统错误，未设置计算任务id，请联系管理员！"));o(!0),h.table(n).get(u).then(i=>{i?h.table(n).update(u,f):h.table(n).add(f),setTimeout(()=>(o(!1),d(!0)),Math.random()*1e3)}).catch(i=>(o(!1),t(i||new Error("系统错误，请联系管理员"))))}));return N.useEffect(()=>{r(()=>y),l(()=>F),T(()=>w),m(()=>S)},[y,F,w,r,l,T,m,S]),{triggerGetData:y,deleteData:F,createOrModifiedData:w,data:p,loading:a,getData:S}}function qt(n,a){const o=a===O.ISOTOPE_FRACTIONATION,p=a===O.FORCE_CONSTANT;if(!o&&!p)return[];if(o){const s=[];return n==null||n.forEach(r=>{const l=r.frequencyInfo,T=(l==null?void 0:l.map(m=>({fractionation:parseFloat(new v(m.fractionation).toFixed(4)),temperature:parseFloat(v.div(v.pow(10,6),v.pow(m.T.kelvin,2)).toFixed(4)),kelvin:m.T.kelvin,celsius:m.T.celsius,category:m.category,name:m.name})))||[];s.push(...T,{fractionation:0,temperature:0,category:r.taskId,name:r.taskName,kelvin:"-",celsius:"-"})}),s}else return(n==null?void 0:n.map(r=>{var m;const l=r.forceConstant,T=r.frequencyInfo;return{category:r.taskId,name:r.taskName,forceConstant:parseFloat(new v(l||0).toFixed(4)),fractionation:parseFloat(new v(((m=T==null?void 0:T[0])==null?void 0:m.fractionation)||0).toFixed(4))}})).filter(Boolean)}function Vt(n){var u,d;const{dataSource:a,type:o,loading:p}=n,s=Ne(),{isLargerThanMinWidth:r}=st(),l=N.useRef(null),T=N.useMemo(()=>`${K[o]||""}-趋势图`,[o]),m=N.useMemo(()=>qt(a,o),[o,a]),[h,c]=N.useState(null),S={data:m,xField:"temperature",yField:"fractionation",nameField:"name",axis:{x:{title:"10⁶/T²（K⁻²）",titleSpacing:10,gridStrokeOpacity:.25},y:{title:"1000lnβ（‰）",titleSpacing:10,gridStrokeOpacity:.25}},seriesField:"name",colorField:"name",slider:r?{x:!0,y:!0}:void 0,tooltip:{title:t=>`温度：${t.kelvin}（K） ${t.celsius}（°C）`,items:[t=>`1000lnβ：${t.fractionation}（‰）`]},theme:s,scale:{x:{nice:!0,domain:[0,14],tickCount:14},y:{nice:!0}},interaction:{brushFilter:!0},sizeField:2},y=N.useMemo(()=>{if(o===O.FORCE_CONSTANT&&!E.isEmpty(m)){const t=m,i=t.map(b=>[b.forceConstant,b.fractionation]),{m:g,b:I}=Ye(i),R=He(i,Ue({m:g,b:I}));c({m:parseFloat(new v(g).toFixed(4)),b:parseFloat(new v(g).toFixed(4)),r2:parseFloat(new v(R).toFixed(4))});const j=v.min(...t.map(b=>b.forceConstant)),x=v.max(...t.map(b=>b.forceConstant));return[{fractionation:v.floor(j).toNumber(),forceConstant:v.floor(j).mul(g).add(I).toNumber()},{fractionation:v.ceil(x).toNumber(),forceConstant:v.ceil(x).mul(g).add(I).toNumber()}]}else return[]},[m,o]),F={data:m,xField:"forceConstant",yField:"fractionation",slider:r?{x:!0,y:!0}:void 0,theme:s,axis:{x:{title:"Force Constant <F> (N/m)",titleSpacing:10,gridStrokeOpacity:.25},y:{title:"1000lnβ（‰）",titleSpacing:10,gridStrokeOpacity:.25}},seriesField:"name",colorField:"name",shapeField:"point",tooltip:{title:t=>`${t.name} `,items:[t=>`1000lnβ：${t.fractionation}（‰）`,t=>`力常数：${t.forceConstant}（N/m）`]},label:{text:"name",transform:[{type:"overlapDodgeY"}],style:{textAlign:"start",textBaseline:"middle",dx:15,position:"left",fontSize:10}},sizeField:6,scale:{x:{nice:!0},y:{nice:!0}},line:{data:y,xField:"fractionation",yField:"forceConstant",style:{stroke:"red",lineWidth:2,lineDash:[5,10],opacity:.8,shadowBlur:5},tooltip:!1,annotations:[{type:"text",data:[(u=y[1])==null?void 0:u.fractionation,(d=y[1])==null?void 0:d.forceConstant],encode:{text:`y = ${h==null?void 0:h.m}x + ${h==null?void 0:h.b}
R² = ${h==null?void 0:h.r2}`},style:{fill:s==="dark"?"#fff":"#000",textAlign:"center",dy:70,dx:-20},tooltip:!1}]},interaction:{brushFilter:!0},style:{fillOpacity:.3,lineWidth:1}},w=k(()=>{var t,i;l&&l.current&&((i=(t=l.current)==null?void 0:t.downloadImage)==null||i.call(t,T))}),f=k(()=>E.isEmpty(m)?e.jsx(Ae,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:120,marginTop:100},description:e.jsx(J.Text,{style:{fontSize:"14px",lineHeight:"25px"},type:"secondary",children:"暂无数据，请新建任务或者选择任务进行计算"})}):o===O.ISOTOPE_FRACTIONATION?e.jsx(ct,{...S,onReady:t=>l.current=t}):o===O.FORCE_CONSTANT?e.jsx(dt,{...F,onReady:t=>l.current=t}):e.jsx(e.Fragment,{}));return e.jsx(e.Fragment,{children:e.jsx(G,{title:T,styles:{body:{minHeight:"450px"}},extra:e.jsx(P,{type:"primary",onClick:w,icon:e.jsx(we,{}),children:"下载图片"}),children:e.jsx(de,{spinning:p,children:f()})})})}const $t=n=>N.useMemo(()=>[{title:"名称",width:120,dataIndex:"name",fixed:"left",onCell:(a,o)=>n===O.ISOTOPE_FRACTIONATION?(o??0)%13===0?{rowSpan:13}:{rowSpan:0}:{rowSpan:1}},...n===O.ISOTOPE_FRACTIONATION?[{title:"摄氏度（°C）",width:120,dataIndex:"celsius"},{title:"华氏度（K）",width:120,dataIndex:"kelvin"},{title:e.jsxs(e.Fragment,{children:["1000/T（K",e.jsx("sup",{children:"-1"}),"）"]}),width:130,dataIndex:"thousand_div_T"},{title:e.jsxs(e.Fragment,{children:["10",e.jsx("sup",{children:"6"}),"/T",e.jsx("sup",{children:"2"}),"（K",e.jsx("sup",{children:"-2"}),"）"]}),width:130,dataIndex:"thousand_div_T_square"},{title:"β",width:80,dataIndex:"beta"},{title:"1000lnβ（‰）",width:130,dataIndex:"fractionation"},{title:"1000(β-1)（‰）",width:150,dataIndex:"thousand_Beta_minor"}]:[],...n===O.FORCE_CONSTANT?[{title:"力常数（N/m）",width:150,dataIndex:"forceConstant"}]:[],{title:"计算同位素",width:110,dataIndex:"isotope",onCell:(a,o)=>n===O.ISOTOPE_FRACTIONATION?(o??0)%13===0?{rowSpan:13}:{rowSpan:0}:{rowSpan:1}},{title:"同位素质量",width:220,dataIndex:"isotopeMass",render:(a,o)=>{const{isotopeMass:p}=o,[s,r]=p||[];return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:s}),e.jsx("div",{children:r})]})},onCell:(a,o)=>n===O.ISOTOPE_FRACTIONATION?(o??0)%13===0?{rowSpan:13}:{rowSpan:0}:{rowSpan:1}},{title:"同位素原子数量",width:130,dataIndex:"isotopeNumber",onCell:(a,o)=>n===O.ISOTOPE_FRACTIONATION?(o??0)%13===0?{rowSpan:13}:{rowSpan:0}:{rowSpan:1}},{title:"固定同位素原子数量",width:160,dataIndex:"fixedIsotopeNumber",onCell:(a,o)=>n===O.ISOTOPE_FRACTIONATION?(o??0)%13===0?{rowSpan:13}:{rowSpan:0}:{rowSpan:1}},{title:"计算模式",width:100,dataIndex:"calculationMethod",onCell:(a,o)=>n===O.ISOTOPE_FRACTIONATION?(o??0)%13===0?{rowSpan:13}:{rowSpan:0}:{rowSpan:1}}],[n]);function zt(n,a){const o=a===O.ISOTOPE_FRACTIONATION,p=a===O.FORCE_CONSTANT;if(!o&&!p)return[];const s=n.map(r=>{var w,f,u,d,t,i;const l=r.taskName,T=r.taskId,m=(w=r.isotopeSetting)==null?void 0:w.isotope,h=[`重同位素质量：${((u=(f=r.isotopeSetting)==null?void 0:f.massSetting)==null?void 0:u.heavy)||"-"}`,`轻同位素质量：${((t=(d=r.isotopeSetting)==null?void 0:d.massSetting)==null?void 0:t.light)||"-"}`],c=(i=r.isotopeSetting)==null?void 0:i.isotopeNumber,S=r.isotopeSetting.fixedIsotopeNumber,y=r.isotopeSetting.isPhonon?K[O.PHONON]:K[O.E_FIELD],F=new v(r.forceConstant||0).toFixed(4);return{taskId:T,name:l,isotope:m,isotopeMass:h,isotopeNumber:c,fixedIsotopeNumber:S,calculationMethod:y,forceConstant:F}});if(o){const r=[];return n.forEach(l=>{const T=l.frequencyInfo||[],m=l.taskId;T.forEach(h=>{const c=h.T.celsius,S=h.T.kelvin,y=v.div(1e3,S).toFixed(4),F=v.div(1e6,v.pow(S,2)).toFixed(4),w=new v(h.beta).toFixed(4),f=new v(h.fractionation).toFixed(4),u=v.sub(w,1).mul(1e3).toFixed(4),d=s.find(t=>t.taskId===m);r.push({...d||{},id:oe(),celsius:c,kelvin:S,thousand_div_T:y,thousand_div_T_square:F,beta:w,fractionation:f,thousand_Beta_minor:u})})}),r.filter(Boolean)}else return s.map(r=>({...r,id:oe()})).filter(Boolean)}const Bt=Object.freeze({name:"名称",celsius:"摄氏度（°C）",kelvin:"华氏度（K）",thousand_div_T:"1000/T（K⁻¹）",thousand_div_T_square:"10⁶/T²（K⁻²）",beta:"β",fractionation:"1000lnβ（‰）",thousand_Beta_minor:"1000(β-1)（‰）",forceConstant:"力常数",isotope:"计算同位素",isotopeMass:"同位素质量",isotopeNumber:"同位素原子数量",fixedIsotopeNumber:"固定同位素原子数量",calculationMethod:"计算模式"});function Wt(n){const{dataSource:a,type:o,loading:p}=n,s=N.useMemo(()=>`${K[o]||""}-数据表`,[o]),r=$t(o),l=N.useMemo(()=>zt(a,o),[a,o]),T=k(()=>{const m=ee.json_to_sheet(l.map(F=>Object.entries(F).reduce((f,[u,d])=>{if(u==="id"||u==="taskId")return f;const t=Bt[u];return f[t]=u==="isotopeMass"?d.join(`
`):d,f},{}))),h=ee.book_new();ee.book_append_sheet(h,m,"sheet1");const c=Ke(h,{bookType:"xlsx",type:"array"}),S=new Blob([c],{type:"application/octet-stream"}),y=document.createElement("a");y.href=URL.createObjectURL(S),y.download="data.xlsx",document.body.appendChild(y),y.click(),document.body.removeChild(y)});return e.jsx(G,{title:s,extra:e.jsx(P,{type:"primary",icon:e.jsx(we,{}),onClick:T,children:"导出数据"}),children:e.jsx(lt,{dataSource:l,columns:r,rowKey:"id",loading:p,scroll:{x:"max-content",scrollToFirstRowOnChange:!0},pagination:{total:(l==null?void 0:l.length)||0,defaultPageSize:20,position:["bottomCenter"]},onHeaderRow:()=>({style:{padding:0}})})})}function Yt(n){const[a,o]=N.useState(!1),[p,s]=N.useState([]),r=new Worker(new URL("/quick-man/dev/main/assets/calculate-BHZdazQT.js",import.meta.url),{type:"module"}),l=new Ce(Fe),T=l.verno;n?l.version(T||je).stores({[n]:be}):A.error("系统错误，未设置工程id，请联系管理员！");async function m(c,S=!0){if(E.isNil(c)||E.isEmpty(c))return s([]),!0;if(!n)return A.error("系统错误，未设置工程id，请联系管理员！"),!1;o(!0);const y=await l.table(n).toArray(),F=[],w=[];c==null||c.forEach(t=>{const i=y.find(x=>x.id===t);if(E.isNil(i))return;const g=i==null?void 0:i.isotopeFractionation,I=i==null?void 0:i.calculationStatus,R=E.isNil(g)||E.isEmpty(g),j=I===z.FAILED;R&&!j?F.push(i):w.push(i)}),r.postMessage({waitToCalculateList:F,calculateType:O.ISOTOPE_FRACTIONATION});const{calculatedTasks:f,isSuccess:u}=await new Promise(t=>{r.onmessage=i=>{t(i.data)}}),d=y.map(t=>{const i=f.find(g=>g.id===t.id);return E.isNil(i)?t:i});return await l.table(n).bulkPut(d),S&&s(f.concat(w).map(t=>{var _;const i=t.id,g=t.name,I=(_=t.isotopeFractionation)==null?void 0:_.map(b=>({fractionation:b.fractionation,beta:b.beta,RPFR:b.RPFR,category:t.id,name:t.name,T:b.T})),R=t.forceConstant,j=t.isPhonon,x=t.isotopeSetting;return{taskId:i,taskName:g,frequencyInfo:I,forceConstant:R,isotopeSetting:{isotope:x.isotope,isFixed:x.fixedIsotopeNumber!==0,isotopeNumber:x.isotopeNumber,fixedIsotopeNumber:x.fixedIsotopeNumber,massSetting:x.massSetting,isPhonon:j}}})),o(!1),u}async function h(c){if(E.isNil(c)||E.isEmpty(c))return s([]),!0;if(!n)return A.error("系统错误，未设置工程id，请联系管理员！"),!1;o(!0);const S=await l.table(n).toArray(),y=[],F=[],w=[];if(c==null||c.forEach(t=>{const i=S.find(b=>b.id===t);if(E.isNil(i))return;const g=i.isotopeFractionation,I=i.forceConstant,R=i==null?void 0:i.calculationStatus,j=E.isEmpty(g)||E.isNil(g),x=E.isNil(I);R===z.FAILED?w.push(i):j?F.push(i):x?y.push(i):w.push(i)}),!E.isEmpty(F))return await m(F.map(i=>i.id),!1)?h(c):(s([]),!1);r.postMessage({waitToCalculateList:y,calculateType:O.FORCE_CONSTANT});const{calculatedTasks:f,isSuccess:u}=await new Promise(t=>{r.onmessage=i=>{t(i.data)}}),d=S.map(t=>{const i=f.find(g=>g.id===t.id);return E.isNil(i)?t:i});return await l.table(n).bulkPut(d),s(f.concat(w).map(t=>{var _;const i=t.id,g=t.name,I=(_=t.isotopeFractionation)==null?void 0:_.map(b=>({fractionation:b.fractionation,beta:b.beta,RPFR:b.RPFR,category:t.id,name:t.name,T:b.T})),R=t.forceConstant,j=t.isPhonon,x=t.isotopeSetting;return{taskId:i,taskName:g,frequencyInfo:I,forceConstant:R,isotopeSetting:{isotope:x.isotope,isFixed:x.fixedIsotopeNumber!==0,isotopeNumber:x.isotopeNumber,fixedIsotopeNumber:x.fixedIsotopeNumber,massSetting:x.massSetting,isPhonon:j}}})),new Promise(t=>{setTimeout(()=>{o(!1),t(u)},Math.random()*2e3)})}return{loading:a,calculationResults:p,setCalculationResults:s,calculateAndSaveFrequency:m,calculateAndSaveForceConstant:h}}function Ht(n){const{id:a}=n,[o]=D.useForm(),{data:p,getData:s,triggerGetData:r,loading:l}=Lt(a),[T,m]=N.useState(0),[h,c]=ie(Re),{calculationResults:S,setCalculationResults:y,loading:F,calculateAndSaveFrequency:w,calculateAndSaveForceConstant:f}=Yt(a),u=N.useMemo(()=>(p==null?void 0:p.map(j=>({label:j.name,value:j.id})))||[],[p]);Je(async()=>{let j=[];try{const b=localStorage.getItem(tt);j=JSON.parse(b||JSON.stringify([]))}catch{A.error("系统错误，解析localStorage中的工程列表出错，请联系管理员！")}const x=j.find(b=>b.id===a);if(!x){A.error("系统错误，获取工程信息失败，请联系管理员！"),c(null);return}c(x),r==null||r();const _=await(s==null?void 0:s());o.setFieldValue("taskIds",(_==null?void 0:_.map(b=>b.id))||[]),o.submit()});const[d,t]=N.useState(!1),i=k(()=>{t(!0)});xe(()=>{d||(r==null||r(),o.submit())},[d]),xe(()=>{y([]),o.submit()},[T,o,y]);const g=()=>{y([]),o.submit()},I=N.useMemo(()=>{var C;const j=(h==null?void 0:h.calculationService)||[],x=j.includes(O.PHONON)||j.includes(O.E_FIELD),_=j.includes(O.FORCE_CONSTANT),b=[...x?[{label:K[O.ISOTOPE_FRACTIONATION],value:O.ISOTOPE_FRACTIONATION}]:[],..._?[{label:K[O.FORCE_CONSTANT],value:O.FORCE_CONSTANT}]:[]];return m(((C=b==null?void 0:b[0])==null?void 0:C.value)||0),b},[h]),R=k(async()=>{const j=o.getFieldValue("taskIds")||[];if(T===O.ISOTOPE_FRACTIONATION)try{await w(j)&&A.success("计算成功！")}catch(x){A.error((x==null?void 0:x.message)||"同位素分馏计算失败，请检查上传文件是否正确！")}else if(T===O.FORCE_CONSTANT)try{await f(j)&&A.success("计算成功！")}catch(x){A.error((x==null?void 0:x.message)||"力常数计算失败，请检查上传文件是否正确！")}});return e.jsxs(e.Fragment,{children:[e.jsxs(W,{direction:"vertical",style:{width:"100%"},children:[e.jsx(et,{title:[e.jsx(qe,{to:"/calculation/qm/isotope-fractionation/frequency",style:{fontSize:"16px"},children:"频率分馏计算"}),e.jsx("span",{style:{fontSize:"16px"},children:"工程详情"})],extra:e.jsx(P,{type:"link",onClick:i,children:"任务列表"})}),e.jsx(G,{title:"计算设置",extra:e.jsx(Ee,{options:I,value:T,onChange:j=>m(j)}),children:e.jsxs(D,{form:o,colon:!0,onFinish:R,onReset:g,layout:"horizontal",preserve:!1,children:[e.jsx(D.Item,{label:"项目名字",name:"taskIds",rules:[{required:!0,message:"必须有项目名字"}],children:e.jsx(te,{allowClear:!0,placeholder:"请输入项目名",options:u,loading:l})}),T===1?e.jsx(D.Item,{label:"温度梯度",name:"temperature_d",children:e.jsx(te,{allowClear:!0,placeholder:"请输入项目名",options:u,loading:l})}):e.jsx(D.Item,{label:"温度选择",name:"tem",children:e.jsx(te,{allowClear:!0,placeholder:"请输入项目名",options:u,loading:l})}),e.jsx(L,{justify:"end",children:e.jsxs(W,{children:[e.jsx(P,{htmlType:"reset",children:"重置"}),e.jsx(P,{htmlType:"submit",type:"primary",loading:F,children:"计算"})]})})]})}),e.jsx(Vt,{dataSource:S,type:T,loading:F}),e.jsx(Wt,{dataSource:S,type:T,loading:F})]}),e.jsx(Dt,{visible:d,onClose:()=>t(!1)})]})}function ss(){const[n]=Ge({id:Xe}),a=N.useMemo(()=>n.id,[n.id]);return N.useEffect(()=>{a||A.error("系统错误，未设置工程id！")},[a]),e.jsx(Qe,{children:e.jsx(Ht,{id:a})})}export{ss as default};
