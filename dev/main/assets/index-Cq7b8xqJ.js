import{k as e,u as ee,r as S,_ as te}from"./react-vendor-BZalFSLS.js";import{eV as L,eW as se,eX as ae,eY as ne,eO as re,eN as k,eZ as ie}from"./other-vendor-BouohHGO.js";import{C as T,a as oe,P as Q,b as le}from"./index-BP21z_dk.js";import{M as N}from"./lodash-vendor-CN3hPSWb.js";import{S as F,e as ce,R,C as h,f as O,g as de,h as J,a as pe,E as U,i as $,F as C,s as P,I as Z,j as me,k as K,m as ue,B as A,c as Y,n as he,T as ye,o as be,G as xe}from"./antd-vendor-ZYx89x1p.js";import{d as I}from"./decimal-vendor-W8_pUBKB.js";import"./__commonjsHelpers__-Cpj98o6Y.js";import"./index-DySw3dyO.js";const fe="本模块只用于计算同位素分馏和力常数值",u={H:"https://s2.loli.net/2024/08/05/JMcXdpn7zl52Fkr.webp",He:"https://s2.loli.net/2024/08/05/qgK8PZQai6LxBVF.webp",Li:"https://s2.loli.net/2024/08/05/zhljmAd7n3kbRKf.webp",Be:"https://s2.loli.net/2024/08/05/K1w4oCWsN3IflMe.webp",B:"https://s2.loli.net/2024/08/05/DSHhvXoueECxVq5.webp",C:"https://s2.loli.net/2024/08/05/7hcKW59Gl8dLabJ.webp",N:"https://s2.loli.net/2024/08/05/hPQLNDjEvJkbG4O.webp",O:"https://s2.loli.net/2024/08/05/LCmVQoSRJKrxiE3.webp",F:"https://s2.loli.net/2024/08/05/RpOe8mbur5lxcFY.webp",Ne:"https://s2.loli.net/2024/08/05/Fy5vboQaR3MNrYA.webp",Na:"https://s2.loli.net/2024/08/05/TeJu64ROl1DEhrd.webp",Mg:"https://s2.loli.net/2024/08/05/aNVsDET3uY28nhH.webp",Al:"https://s2.loli.net/2024/08/05/ZBs8nCW1GhA69wl.webp",Si:"https://s2.loli.net/2024/08/05/KmBDIQGPyOf6tUN.webp",P:"https://s2.loli.net/2024/08/05/L2nvcKtMJ1oVB3E.webp",S:"https://s2.loli.net/2024/08/05/bNak4GCK9FrQlcj.webp",Cl:"https://s2.loli.net/2024/08/05/hUnvNA4RqyX5o3p.webp",Ar:"https://s2.loli.net/2024/08/05/nq4W2Ofs7gCoxVU.webp",K:"https://s2.loli.net/2024/08/05/o5hctplqxnz8AIJ.webp",Ca:"https://s2.loli.net/2024/08/05/l8bP5mQjfJCo6rB.webp",Ba:"https://s2.loli.net/2024/08/05/jLBJzyWErVPtx6Z.webp",Ag:"https://s2.loli.net/2024/08/05/ySo56ZzHM1DwvP4.webp"};var W=(n=>(n.STABLE="Stable",n.RADIOACTIVE="Radioactive",n))(W||{});const H=[{name:"H（氢 / Hydrogen）",key:"H",index:1,overview:{picture_url:u.H,EN_name:"Hydrogen",ZhCN_name:"氢",relative_mass:"1.00794",density:""},properties:{isotope:[{mass:"1.007825",abundance:"0.999844",type:"Stable"},{mass:"2.014102",abundance:"0.000156",type:"Stable"},{mass:"3.016049",abundance:"0.00004",type:"Stable"}]}},{name:"He（氦 / Helium）",key:"He",index:2,overview:{picture_url:u.He,EN_name:"Helium",ZhCN_name:"氦",relative_mass:"4.0026",density:""},properties:{isotope:[{mass:"3.016029",abundance:"0.00000137",type:"Stable"},{mass:"4.002606",abundance:"0.99999863",type:"Stable"}]}},{name:"Li（锂 / Lithium）",key:"Li",index:3,overview:{picture_url:u.Li,EN_name:"Lithium",ZhCN_name:"锂",relative_mass:"6.9675",density:""},properties:{isotope:[{mass:"6.015122",abundance:"0.0759",type:"Stable"},{mass:"7.016004",abundance:"0.9241",type:"Stable"}]}},{name:"Be（铍 / Beryllium）",key:"Be",index:4,overview:{picture_url:u.Be,EN_name:"Beryllium",ZhCN_name:"铍",relative_mass:"9.0122",density:""},properties:{isotope:[{mass:"7.016929",abundance:"0",type:"Radioactive"},{mass:"9.012182",abundance:"1",type:"Stable"},{mass:"10.013533",abundance:"0",type:"Radioactive"}]}},{name:"B（硼 / Boron）",key:"B",index:5,overview:{picture_url:u.B,EN_name:"Boron",ZhCN_name:"硼",relative_mass:"10.8135",density:""},properties:{isotope:[{mass:"10.012937",abundance:"0.199",type:"Stable"},{mass:"11.009306",abundance:"0.801",type:"Stable"}]}},{name:"C（碳 / Carbon）",key:"C",index:6,overview:{picture_url:u.C,EN_name:"Carbon",ZhCN_name:"碳",relative_mass:"12.0106",density:""},properties:{isotope:[{mass:"11.011433",abundance:"0",type:"Radioactive"},{mass:"12.000000",abundance:"0.989",type:"Stable"},{mass:"13.00335483",abundance:"0.011",type:"Stable"},{mass:"14.003241",abundance:"0",type:"Radioactive"}]}},{name:"N（氮 / Nitrogen）",key:"N",index:7,overview:{picture_url:u.N,EN_name:"Nitrogen",ZhCN_name:"氮",relative_mass:"14.0069",density:""},properties:{isotope:[{mass:"13.005738",abundance:"0",type:"Radioactive"},{mass:"14.003074005",abundance:"0.9963",type:"Stable"},{mass:"15.000108898",abundance:"0.0037",type:"Stable"}]}},{name:"O（氧 / Oxygen）",key:"O",index:8,overview:{picture_url:u.O,EN_name:"Oxygen",ZhCN_name:"氧",relative_mass:"15.9994",density:""},properties:{isotope:[{mass:"15.003065",abundance:"0",type:"Radioactive"},{mass:"15.99491462",abundance:"0.99762",type:"Stable"},{mass:"16.999131",abundance:"0.00038",type:"Stable"},{mass:"17.99916",abundance:"0.002",type:"Stable"},{mass:"19.003579",abundance:"0",type:"Radioactive"}]}},{name:"F（氟 / Fluorine）",key:"F",index:9,overview:{picture_url:u.F,EN_name:"Fluorine",ZhCN_name:"氟",relative_mass:"18.9984",density:""},properties:{isotope:[{mass:"18.000937",abundance:"0",type:"Radioactive"},{mass:"18.9984032",abundance:"1",type:"Stable"},{mass:"19.999981",abundance:"0",type:"Radioactive"}]}},{name:"Ne（氖 / Neon）",key:"Ne",index:10,overview:{picture_url:u.Ne,EN_name:"Neon",ZhCN_name:"氖",relative_mass:"20.1800",density:""},properties:{isotope:[{mass:"19.99244",abundance:"0.9048",type:"Stable"},{mass:"20.993847",abundance:"0.0027",type:"Stable"},{mass:"21.991386",abundance:"0.0925",type:"Stable"}]}},{name:"Na（钠 / Sodium）",key:"Na",index:11,overview:{picture_url:u.Na,EN_name:"Sodium",ZhCN_name:"钠",relative_mass:"22.9898",density:""},properties:{isotope:[{mass:"21.994436",abundance:"0",type:"Radioactive"},{mass:"22.98977",abundance:"1",type:"Stable"},{mass:"23.990963",abundance:"0",type:"Radioactive"}]}},{name:"Mg（镁 / Magnesium）",key:"Mg",index:12,overview:{picture_url:u.Mg,EN_name:"Magnesium",ZhCN_name:"镁",relative_mass:"24.3051",density:""},properties:{isotope:[{mass:"23.985042",abundance:"0.7899",type:"Stable"},{mass:"24.985837",abundance:"0.1",type:"Stable"},{mass:"25.982593",abundance:"0.1101",type:"Stable"},{mass:"26.984341",abundance:"0",type:"Radioactive"},{mass:"27.983876",abundance:"0",type:"Radioactive"}]}},{name:"Al（铝 / Aluminum）",key:"Al",index:13,overview:{picture_url:u.Al,EN_name:"Aluminum",ZhCN_name:"铝",relative_mass:"26.9815",density:""},properties:{isotope:[{mass:"25.986891",abundance:"0",type:"Radioactive"},{mass:"26.981538",abundance:"1",type:"Stable"},{mass:"27.98191",abundance:"0",type:"Radioactive"},{mass:"28.980445",abundance:"0",type:"Radioactive"}]}},{name:"Si（硅 / Silicon）",key:"Si",index:14,overview:{picture_url:u.Si,EN_name:"Silicon",ZhCN_name:"硅",relative_mass:"28.0850",density:""},properties:{isotope:[{mass:"27.976926",abundance:"0.9223",type:"Stable"},{mass:"28.976497",abundance:"0.0467",type:"Stable"},{mass:"29.97377",abundance:"0.031",type:"Stable"},{mass:"30.975363",abundance:"0",type:"Radioactive"},{mass:"31.974148",abundance:"0",type:"Radioactive"}]}},{name:"P（磷 / Phosphorus）",key:"P",index:15,overview:{picture_url:u.P,EN_name:"Phosphorus",ZhCN_name:"磷",relative_mass:"30.9738",density:""},properties:{isotope:[{mass:"30.973761",abundance:"1",type:"Stable"},{mass:"31.973907",abundance:"0",type:"Radioactive"},{mass:"32.971725",abundance:"0",type:"Radioactive"}]}},{name:"S（硫 / Sulfur）",key:"S",index:16,overview:{picture_url:u.S,EN_name:"Sulfur",ZhCN_name:"硫",relative_mass:"32.0648",density:""},properties:{isotope:[{mass:"31.97207",abundance:"0.9502",type:"Stable"},{mass:"32.971458",abundance:"0.0075",type:"Stable"},{mass:"33.967866",abundance:"0.0421",type:"Stable"},{mass:"34.969032",abundance:"0",type:"Radioactive"},{mass:"35.96708",abundance:"0.0002",type:"Stable"},{mass:"36.971125",abundance:"0",type:"Radioactive"},{mass:"37.971163",abundance:"0",type:"Radioactive"}]}},{name:"Cl（氯 / Chlorine）",key:"Cl",index:17,overview:{picture_url:u.Cl,EN_name:"Chlorine",ZhCN_name:"氯",relative_mass:"35.4521",density:""},properties:{isotope:[{mass:"34.9688527",abundance:"0.7577",type:"Stable"},{mass:"35.968306",abundance:"0",type:"Radioactive"},{mass:"36.9659026",abundance:"0.2423",type:"Stable"},{mass:"37.96801",abundance:"0",type:"Radioactive"},{mass:"38.968",abundance:"0",type:"Radioactive"}]}},{name:"Ar（氩 / Argon）",key:"Ar",index:18,overview:{picture_url:u.Ar,EN_name:"Argon",ZhCN_name:"氩",relative_mass:"39.9478",density:""},properties:{isotope:[{mass:"35.967546",abundance:"0.00337",type:"Stable"},{mass:"36.966775",abundance:"0",type:"Radioactive"},{mass:"37.962732",abundance:"0.00063",type:"Stable"},{mass:"38.964313",abundance:"0",type:"Radioactive"},{mass:"39.962383",abundance:"0.996",type:"Stable"},{mass:"40.964501",abundance:"0",type:"Radioactive"},{mass:"41.96305",abundance:"0",type:"Radioactive"}]}},{name:"K（钾 / Potassium）",key:"K",index:19,overview:{picture_url:u.K,EN_name:"Potassium",ZhCN_name:"钾",relative_mass:"39.0983",density:""},properties:{isotope:[{mass:"38.963707",abundance:"0.932581",type:"Stable"},{mass:"39.963999",abundance:"0.000117",type:"Radioactive"},{mass:"40.961826",abundance:"0.067302",type:"Stable"},{mass:"41.962403",abundance:"0",type:"Radioactive"},{mass:"42.960716",abundance:"0",type:"Radioactive"}]}},{name:"Ca（钙 / Calcium）",key:"Ca",index:20,overview:{picture_url:u.Ca,EN_name:"Calcium",ZhCN_name:"钙",relative_mass:"40.0780",density:""},properties:{isotope:[{mass:"39.962591",abundance:"0.96941",type:"Stable"},{mass:"40.962278",abundance:"0",type:"Radioactive"},{mass:"41.958618",abundance:"0.00647",type:"Stable"},{mass:"42.958767",abundance:"0.00135",type:"Stable"},{mass:"43.955481",abundance:"0.02086",type:"Stable"},{mass:"44.956185",abundance:"0",type:"Radioactive"},{mass:"45.953693",abundance:"0.00004",type:"Stable"},{mass:"46.954546",abundance:"0",type:"Radioactive"},{mass:"47.952533",abundance:"0.00187",type:"Stable"}]}},{name:"Ag（银 / Silver）",key:"Ag",index:47,overview:{picture_url:u.Ag,EN_name:"Silver",ZhCN_name:"银",relative_mass:"107.8681",density:""},properties:{isotope:[{mass:"104.906528",abundance:"0",type:"Radioactive"},{mass:"105.906666",abundance:"0",type:"Radioactive"},{mass:"106.905093",abundance:"0.51839",type:"Stable"},{mass:"108.904756",abundance:"0.48161",type:"Stable"},{mass:"109.90611",abundance:"0",type:"Radioactive"},{mass:"110.905295",abundance:"0",type:"Radioactive"}]}},{name:"Ba（钡 / Barium）",key:"Ba",index:56,overview:{picture_url:u.Ba,EN_name:"Barium",ZhCN_name:"钡",relative_mass:"137.3267",density:""},properties:{isotope:[{mass:"129.906311",abundance:"0.00106",type:"Stable"},{mass:"130.906931",abundance:"0",type:"Radioactive"},{mass:"131.905056",abundance:"0.00101",type:"Stable"},{mass:"132.906002",abundance:"0",type:"Radioactive"},{mass:"133.904503",abundance:"0.0242",type:"Stable"},{mass:"134.905684",abundance:"0.06593",type:"Stable"},{mass:"135.904571",abundance:"0.0785",type:"Stable"},{mass:"136.905823",abundance:"0.1123",type:"Stable"},{mass:"137.905242",abundance:"0.717",type:"Stable"},{mass:"139.910599",abundance:"0",type:"Radioactive"}]}}];function je(n){const{element:t}=n,{overview:s,index:a}=H.find(i=>i.key===t)||{},{EN_name:r,ZhCN_name:d,picture_url:c,relative_mass:l}=s;return e.jsxs("div",{style:{backgroundImage:`url(${c})`,backgroundPosition:"center",backgroundSize:"cover",position:"relative",height:"260px"},children:[e.jsx("div",{style:{position:"absolute",bottom:0,left:0,width:"100%",height:"150px",background:"linear-gradient(to top, rgba(0, 0, 0, 0.5), rgba(255, 255, 255, 0))",backdropFilter:"blur(.4px)"}}),e.jsxs("div",{style:{position:"absolute",bottom:"10px",left:"20px"},children:[e.jsx("div",{style:{color:"#fff",fontWeight:400,fontSize:20},children:e.jsxs(F,{align:"end",children:[e.jsx("span",{children:d}),e.jsx("sub",{style:{fontSize:16},children:a})]})}),e.jsx("div",{style:{color:"#fff",fontWeight:700,fontSize:26},children:r}),e.jsxs("div",{style:{color:"#fff",fontWeight:500,fontSize:16},children:[l," (g/mol)"]})]})]})}function q(n){const{isotopeName:t,isotopeMass:s}=n;return e.jsx(ce,{color:"cyan",children:e.jsxs("span",{children:[e.jsx("sup",{style:{fontSize:"8px",lineHeight:"8px"},children:s}),t]})})}function D(n,t){if(!t||N.isEmpty(t))return null;let s=null;return t==null||t.some(a=>{if(a.value===n)return s=a,!0;{const r=D(n,a.children||[]);return r&&r.value===n?(s=r,!0):!1}}),s||null}const ve=n=>{var w,_;const{project:t,deleteProject:s,editProject:a}=n||{},{id:r,isotopeMass:d,calculationElement:c,createTime:l,projectDescription:i,updateTime:p,calculationService:o}=t||{},m=ee(),v=S.useMemo(()=>{const y=(o==null?void 0:o.map(j=>{var x;return console.log({item:j}),console.log({findNode:D(j,T)}),(x=D(j,T))==null?void 0:x.label}))||[];return y==null?void 0:y.join("、")},[o]),b=()=>{pe.confirm({title:"删除工程",content:"工程删除后，该工程中包含的计算任务也会被一并删除，是否确认删除？",cancelText:"取消",onCancel:y=>{y()},onOk:y=>{s(r),y()},centered:!0,style:{maxWidth:"80vw"}})},f=S.useMemo(()=>{var y,j;return e.jsxs(F,{direction:"vertical",size:2,style:{width:"100%"},children:[e.jsxs(R,{wrap:!1,children:[e.jsx(h,{style:{minWidth:"80px"},children:"同位素："}),e.jsxs(h,{style:{overflow:"hidden",whiteSpace:"snowrap",textOverflow:"ellipsis"},flex:1,children:[e.jsx(q,{isotopeMass:(y=d.light)==null?void 0:y.round,isotopeName:c}),e.jsx(q,{isotopeMass:(j=d.heavy)==null?void 0:j.round,isotopeName:c})]})]}),e.jsxs(R,{wrap:!1,children:[e.jsx(h,{style:{minWidth:"80px"},children:"计算服务："}),e.jsx(h,{style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},flex:1,children:e.jsxs(O,{title:v,children:[" ",v]})})]}),e.jsxs(R,{wrap:!1,children:[e.jsx(h,{style:{minWidth:"80px"},children:"创建时间："}),e.jsx(h,{style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},flex:1,children:L(l).format("YYYY-MM-DD HH:mm:ss")||"-"})]}),e.jsxs(R,{wrap:!1,children:[e.jsx(h,{style:{minWidth:"80px"},children:"更新时间："}),e.jsx(h,{style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},flex:1,children:p?L(p).format("YYYY-MM-DD HH:mm:ss"):"-"})]}),e.jsxs(R,{wrap:!1,children:[e.jsx(h,{style:{minWidth:"80px"},children:"详细信息："}),e.jsx(O,{title:i||"",children:e.jsx(h,{style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},flex:1,children:i||"-"})})]})]})},[c,l,(w=d.heavy)==null?void 0:w.round,(_=d.light)==null?void 0:_.round,i,v,p]);return e.jsx(de.Ribbon,{text:"仅本人",color:"green",children:e.jsx(J,{hoverable:!0,cover:e.jsx(je,{element:t.calculationElement}),actions:[e.jsx(O,{title:"进入工程",children:e.jsx(se,{onClick:()=>m(`/calculation/qm/isotope-fractionation/frequency/detail?id=${t.id}`)},"setting")}),e.jsx(O,{title:"修改工程",children:e.jsx(ae,{onClick:()=>a(r)},"edit")}),e.jsx(O,{title:"删除工程",children:e.jsx(ne,{onClick:b},"delete")})],style:{overflow:"hidden"},children:e.jsx(J.Meta,{title:t.projectName,description:f})})})},ge=n=>{const{projectList:t,deleteProject:s,editProject:a}=n;return N.isEmpty(t)?e.jsx(U,{imageStyle:{height:"120px",marginTop:"180px"},description:"未搜索到结果～"}):e.jsx(R,{gutter:[12,12],children:t.map(r=>e.jsx(h,{xs:24,sm:24,md:12,lg:8,xxl:6,children:e.jsx(ve,{project:r,deleteProject:()=>s(r.id),editProject:a},r.id)}))})},Se=ge;function we(n){var c,l;const{value:t,onChange:s,massArray:a}=n,r=i=>{const p=a==null?void 0:a.find(o=>I.round(o).toNumber()===i);s==null||s({light:{round:i||void 0,precision:p},heavy:t==null?void 0:t.heavy})},d=i=>{const p=a==null?void 0:a.find(o=>I.round(o).toNumber()===i);s==null||s({light:t==null?void 0:t.light,heavy:{round:i||void 0,precision:p}})};return e.jsxs(F,{children:[e.jsx($,{addonBefore:"轻",precision:0,value:(c=t==null?void 0:t.light)==null?void 0:c.round,onChange:r}),e.jsx($,{addonBefore:"重",precision:0,value:(l=t==null?void 0:t.heavy)==null?void 0:l.round,onChange:d})]})}const G=[{label:"仅本人",value:1},{label:"所有人",value:0}],_e={readPermission:1,editPermission:1},Ce=[{validator(n,t){var r,d;const s=(r=t==null?void 0:t.light)==null?void 0:r.round,a=(d=t==null?void 0:t.heavy)==null?void 0:d.round;return!s||!a?Promise.reject(new Error("必须完整填写同位素质量数")):s>=a?Promise.reject(new Error("轻同位素质量数必须小于重质量同位素")):Promise.resolve()}},{required:!0},({getFieldValue:n})=>({validator(t,s){var v,b,f,w,_,y,j;const a=n("calculationElement");if(!a)return Promise.reject(new Error("未选择计算元素"));const r=((f=(b=(v=H.find(x=>x.key===a))==null?void 0:v.properties)==null?void 0:b.isotope)==null?void 0:f.filter(x=>x.type===W.STABLE).map(x=>x.mass))||[],d=r.map(x=>I.round(x));if(N.isEmpty(r))return Promise.reject(new Error("未设置系统质量数，请反馈管理员修改"));const c=I.min(...r).round().toNumber(),l=I.max(...r).round().toNumber(),i=(w=s==null?void 0:s.light)==null?void 0:w.round,p=(_=s==null?void 0:s.heavy)==null?void 0:_.round,o=(y=s==null?void 0:s.light)==null?void 0:y.precision,m=(j=s==null?void 0:s.heavy)==null?void 0:j.precision;return i&&i<c?Promise.reject(new Error(`${a} 同位素的最小质量不能小于 ${c}`)):p&&p>l?Promise.reject(new Error(`${a} 同位素的最大质量不能大于 ${l}`)):o?m?Promise.resolve():Promise.reject(new Error(`重同位素质量数不在 ${d.join("、")} 可选范围内`)):Promise.reject(new Error(`轻同位素质量数不在 ${d.join("、")} 可选范围内`))}})],B=H.map(n=>({label:n.name,value:n.key})),{useWatch:Ne}=C;function Pe(n){const{form:t,rules:s,singleFormItem:a=!1,required:r=!0}=n,[d,c]=S.useState([]),[l,i]=S.useState(B),p=Ne("calculationElement",t);return S.useEffect(()=>{var b,f,w,_,y,j,x;const o=((w=(f=(b=H.find(g=>g.key===p))==null?void 0:b.properties)==null?void 0:f.isotope)==null?void 0:w.filter(g=>g.type===W.STABLE).map(g=>g.mass))||[];c(o);const[m,v]=[(y=(_=t.getFieldValue("isotopeMass"))==null?void 0:_.light)==null?void 0:y.round,(x=(j=t.getFieldValue("isotopeMass"))==null?void 0:j.heavy)==null?void 0:x.round];t.setFieldsValue({isotopeMass:{light:{round:m,precision:o==null?void 0:o.find(g=>I.round(g).toNumber()===m)},heavy:{round:v,precision:o==null?void 0:o.find(g=>I.round(g).toNumber()===v)}}}),t.validateFields(["isotopeMass"])},[t,p]),e.jsx(e.Fragment,{children:e.jsx(C,{form:t,labelCol:{span:8},colon:!0,layout:"inline",onFinishFailed:()=>P.error("请完整填写表单信息"),initialValues:_e,children:e.jsxs(R,{gutter:[12,26],children:[e.jsx(h,{span:a?24:12,children:e.jsx(C.Item,{label:"工程名字",name:"projectName",rules:[...N.get(s,"projectName")||[],{required:r,message:"工程名不允许为空"}],children:e.jsx(Z,{allowClear:!0,placeholder:"请输入工程名",autoComplete:"off"})})}),e.jsx(h,{span:a?24:12,children:e.jsx(C.Item,{label:"计算服务",name:"calculationService",rules:[...N.get(s,"calculationService")||[],{required:r,message:"计算服务不允许为空"}],extra:"建议全选",children:e.jsx(oe,{options:T,showCheckedStrategy:"SHOW_CHILD",placeholder:"请选择计算服务",allowClear:!0})})}),e.jsx(h,{span:a?24:12,children:e.jsx(C.Item,{label:"计算元素",name:"calculationElement",rules:[...N.get(s,"calculationElement")||[],{required:r,message:"计算元素不允许为空"}],children:e.jsx(me,{showSearch:!0,filterOption:!1,options:l,allowClear:!0,placeholder:"请选择计算元素",onSearch:o=>{if(!o)return i(B);const v=B.filter(b=>b.label.toLocaleLowerCase().includes(o.toLocaleLowerCase())).map(b=>({...b,label:e.jsx("span",{children:b.label.split(new RegExp(`(${o})`,"gi")).map((f,w)=>f.toLowerCase()===o.toLowerCase()?e.jsx("span",{style:{color:"orange"},children:f},w):f)})}));i(v)},onClear:()=>i(B),onSelect:()=>i(B)})})}),e.jsx(h,{span:a?24:12,children:e.jsx(C.Item,{label:"同位素质量",name:"isotopeMass",dependencies:["calculationElement"],rules:[...Ce,...N.get(s,"isotopeMass")||[]],children:e.jsx(we,{massArray:d})})}),e.jsx(h,{span:a?24:12,children:e.jsx(C.Item,{label:"可见范围",name:"readPermission",rules:[...N.get(s,"readPermission")||[],{required:r,message:"可见范围不允许为空"}],extra:"目前仅支持本人可见",children:e.jsx(K,{options:G,style:{width:"100%"},multiple:!0,showCheckedStrategy:"SHOW_CHILD",maxTagCount:"responsive",showSearch:!0,disabled:!0})})}),e.jsx(h,{span:a?24:12,children:e.jsx(C.Item,{label:"可编辑范围",name:"editPermission",rules:[...N.get(s,"editPermission")||[],{required:r,message:"可编辑范围不允许为空"}],extra:"目前仅支持本人可编辑",children:e.jsx(K,{options:G,style:{width:"100%"},multiple:!0,showCheckedStrategy:"SHOW_CHILD",maxTagCount:"responsive",showSearch:!0,disabled:!0})})}),e.jsx(h,{span:a?24:12,children:e.jsx(C.Item,{label:"详细信息",name:"projectDescription",children:e.jsx(Z.TextArea,{placeholder:"请输入项目的详细描述信息",autoSize:{minRows:4,maxRows:6},maxLength:300,showCount:!0,autoComplete:"off"})})})]})})})}function V(){if(!window.localStorage)throw new Error("当前浏览器不支持使用本地存储，清更换Chrome浏览器或者打开localStorage权限！");return!0}function z(){let n=[];try{const t=localStorage.getItem(Q);n=JSON.parse(t||JSON.stringify([]))}catch{throw new Error("系统错误，解析localStorage中的工程列表出错，请联系管理员！")}return n}function X(n){try{const t=JSON.stringify(n);localStorage.setItem(Q,t)}catch{throw new Error("系统错误，序列化工程信息出错，请联系管理员！")}return!0}function Ee(){const[n,t]=S.useState(!1);return{createOrModifiedProject:(a,r)=>new Promise((d,c)=>{var o;try{V()}catch(m){return c(m)}if(!r)return c(new Error("系统错误，未设置工程id，请联系管理员！"));t(!0);let l=[];try{l=z()}catch(m){return c(m)}const i=l.findIndex(m=>(m==null?void 0:m.id)===r);let p=[];i!==-1?(l[i]={...a,id:r,createTime:((o=l[i])==null?void 0:o.createTime)||L().valueOf(),updateTime:L().valueOf()},p=[...l]):p=[...l,{id:r,...a,createTime:L().valueOf(),updateTime:L().valueOf()}];try{X(p)}catch(m){return c(m)}i===-1&&localStorage.setItem(r,JSON.stringify([])),setTimeout(()=>(t(!1),d(!0)),Math.random()*1e3)}),loading:n}}function Re(n){try{V()}catch(a){return P.error(a.message),!1}if(!n)return P.error("系统错误，未设置工程id，请联系管理员！"),!1;let t=[];try{t=z()}catch(a){return P.error(a.message),!1}const s=t.filter(a=>(a==null?void 0:a.id)!==n);try{X(s)}catch(a){return P.error(a.message),!1}return localStorage.removeItem(n),!0}function Me(){const[n,t]=S.useState(!1),[s,a]=S.useState([]);return{triggerGetProjects:d=>{try{V()}catch(i){P.error(i.message);return}t(!0);let c=[],l=[];try{c=z()}catch(i){P.error(i.message);return}d?l=c.filter(p=>{var o;return(o=p==null?void 0:p.projectName)==null?void 0:o.includes(d)}):l=c,setTimeout(()=>{t(!1),a(l)},Math.random()*1e3)},projectList:s,loading:n}}const{useBreakpoint:Ie}=xe;function Ze(){const[n]=C.useForm(),[t,s]=S.useState(!1),[a,r]=S.useState(""),[d,c]=S.useState(!1),[l,i]=S.useState(!1),{createOrModifiedProject:p,loading:o}=Ee(),{triggerGetProjects:m,loading:v,projectList:b}=Me();re(()=>{m()});const f=k(()=>{n.resetFields(),s(!0),r(ie()),i(!1)}),w=k(E=>{Re(E),m()}),_=k(E=>{r(E),n.setFieldsValue(b.find(M=>M.id===E)||{}),s(!0),i(!0)}),y=k(()=>{s(!1)}),j=k(async()=>{await n.validateFields();const E=n.getFieldsValue(!0);try{await p(E,a)?P.success(`工程${l?"修改":"创建"}成功！`):P.error(`工程${l?"修改":"创建"}失败！`)}catch(M){console.log({error:M}),P.error(`工程${l?"修改":"创建"}失败！${(M==null?void 0:M.message)||""}`)}y(),m()}),x=k(()=>e.jsx(R,{justify:"end",children:e.jsxs(F,{children:[e.jsx(A,{onClick:y,children:"取消"}),e.jsx(A,{type:"primary",onClick:j,children:"确定"})]})})),{md:g}=Ie();return S.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[t]),e.jsxs(e.Fragment,{children:[e.jsx(le,{title:"频率分馏计算"}),e.jsxs(F,{direction:"vertical",style:{width:"100%"},children:[e.jsx(ue,{message:e.jsx(te,{speed:30,delay:5,children:fe}),type:"info",showIcon:!0,closable:!0}),e.jsxs(R,{justify:"space-between",gutter:12,wrap:!1,children:[e.jsx(h,{flex:1,children:e.jsx(Z.Search,{placeholder:"请输入工程名进行搜索",allowClear:!0,onSearch:E=>{m(E),c(!!E)}})}),e.jsx(h,{children:e.jsx(A,{type:"primary",onClick:f,children:"新增工程"})})]}),e.jsx(Y,{spinning:v,children:!d&&N.isEmpty(b)?e.jsx("div",{style:{margin:"100px auto"},children:e.jsx(U,{image:"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg",imageStyle:{height:200},description:"还未创建工程，赶紧尝试一下吧～",children:e.jsx(A,{type:"primary",onClick:f,children:"立即创建"})})}):e.jsx(Se,{projectList:b,deleteProject:w,editProject:_})})]}),e.jsx(he,{title:"新建工程",extra:e.jsxs(ye.Text,{type:"secondary",style:{maxWidth:g?"":"60vw"},ellipsis:!0,children:["工程id：",a]}),placement:g?"right":"bottom",closable:!1,open:t,size:"large",height:"75vh",maskClosable:!1,footer:x(),children:e.jsx(Y,{spinning:o,children:e.jsx(Pe,{form:n,required:!0,singleFormItem:!g})})}),e.jsx(be.BackTop,{visibilityHeight:200,type:"primary",style:{marginBottom:80}})]})}export{Ze as default};
